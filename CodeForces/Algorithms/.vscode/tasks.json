{
  //===------------------------------------------------------------------------===//
  // VS Code tasks for Competitive Programming (CP-first workflow).
  //
  // Design goals:
  // - keep tasks aligned with cpptools as the canonical interface
  // - keep sanitizer logic centralized and OS-aware via helper script
  //===------------------------------------------------------------------------===//
  "version": "2.0.0",
  "options": {
    "cwd": "${workspaceFolder}"
  },
  "tasks": [
    //===------------------------------ BUILD --------------------------------===//
    {
      "label": "Build: Active File (Debug)",
      "type": "shell",
      "command": "zsh",
      "args": [
        "-lc",
        "cpptools conf Debug auto && cpptools build ${fileBasenameNoExtension}"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Configure Debug (auto compiler) and build the active problem target."
    },
    {
      "label": "Build: Active File (Release)",
      "type": "shell",
      "command": "zsh",
      "args": [
        "-lc",
        "cpptools conf Release auto && cpptools build ${fileBasenameNoExtension}"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Configure Release (auto compiler) and build the active problem target."
    },
    {
      "label": "Build: Active File (Sanitize, Auto OS)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "build",
        "${fileBasenameNoExtension}",
        "auto"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Build with sanitizer profile. Uses Clang on macOS and default sanitizer compiler on Linux."
    },
    {
      "label": "Build: Active File (Sanitize, Clang)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "build",
        "${fileBasenameNoExtension}",
        "clang"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Build with sanitizer profile using Clang."
    },
    {
      "label": "Build: Active File (Sanitize, GCC Linux Only)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "build",
        "${fileBasenameNoExtension}",
        "gcc"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Build with sanitizer profile using GCC. Linux-only; macOS is explicitly blocked."
    },

    //===--------------------------- RUN AND TEST -----------------------------===//
    {
      "label": "Run: Build and Run Active File",
      "type": "shell",
      "command": "cpptools",
      "args": ["go", "${fileBasenameNoExtension}"],
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Build and run the active problem in the currently configured profile."
    },
    {
      "label": "Run: Build and Run Active File (Prompt Input)",
      "type": "shell",
      "command": "zsh",
      "args": [
        "-lc",
        "cpptools go ${fileBasenameNoExtension} \"${input:inputFile}\""
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Build and run active problem using a user-selected input file."
    },
    {
      "label": "Run: Build and Run Active File (Sanitize, Auto OS)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "go",
        "${fileBasenameNoExtension}",
        "auto"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Run active problem with sanitizers. Uses Clang on macOS and sanitizer default on Linux."
    },
    {
      "label": "Run: Build and Run Active File (Sanitize, GCC Linux Only)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "go",
        "${fileBasenameNoExtension}",
        "gcc"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Run active problem with GCC sanitizers on Linux. Blocked on macOS."
    },
    {
      "label": "Test: Judge Active File",
      "type": "shell",
      "command": "cpptools",
      "args": ["judge", "${fileBasenameNoExtension}"],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Run sample-case judging for the active problem in the current profile."
    },
    {
      "label": "Test: Judge Active File (Sanitize, Auto OS)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "judge",
        "${fileBasenameNoExtension}",
        "auto"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Judge active problem with sanitizer instrumentation."
    },
    {
      "label": "Test: Judge Active File (Sanitize, GCC Linux Only)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "judge",
        "${fileBasenameNoExtension}",
        "gcc"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Judge with GCC sanitizers on Linux. Blocked on macOS."
    },
    {
      "label": "Test: Stress Active File",
      "type": "shell",
      "command": "cpptools",
      "args": ["stress", "${fileBasenameNoExtension}", "${input:stressIterations}"],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Run stress testing for active problem with configurable iteration count."
    },
    {
      "label": "Test: Stress Active File (Sanitize, Auto OS)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "stress",
        "${fileBasenameNoExtension}",
        "auto",
        "${input:stressIterations}"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Run stress test under sanitizer instrumentation."
    },

    //===---------------------------- SUBMISSION ------------------------------===//
    {
      "label": "Submit: Generate Active File (Strict)",
      "type": "shell",
      "command": "cpptools",
      "args": ["submit", "--strict", "${fileBasenameNoExtension}"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Generate strict single-file submission artifact for active problem."
    },
    {
      "label": "Submit: Test Active File Submission (Strict)",
      "type": "shell",
      "command": "cpptools",
      "args": ["test-submit", "--strict", "${fileBasenameNoExtension}"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Compile and run strict submission artifact for active problem."
    },
    {
      "label": "Workflow: Validate and Submit Active File (Strict)",
      "type": "shell",
      "command": "zsh",
      "args": [
        "-lc",
        "cpptools judge ${fileBasenameNoExtension} && cpptools submit --strict ${fileBasenameNoExtension} && cpptools test-submit --strict ${fileBasenameNoExtension}"
      ],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Judge, generate strict submission, then test strict submission end-to-end."
    },

    //===---------------------- CONFIGURATION AND CLEAN -----------------------===//
    {
      "label": "Configure: Debug (Auto Compiler)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Debug", "auto"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Debug profile and auto compiler detection."
    },
    {
      "label": "Configure: Debug (GCC)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Debug", "gcc"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Debug profile using GCC."
    },
    {
      "label": "Configure: Debug (Clang)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Debug", "clang"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Debug profile using Clang."
    },
    {
      "label": "Configure: Release (Auto Compiler)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Release", "auto"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Release profile and auto compiler detection."
    },
    {
      "label": "Configure: Release (GCC)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Release", "gcc"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Release profile using GCC."
    },
    {
      "label": "Configure: Release (Clang)",
      "type": "shell",
      "command": "cpptools",
      "args": ["conf", "Release", "clang"],
      "problemMatcher": [],
      "detail": "Reconfigure CMake with Release profile using Clang."
    },
    {
      "label": "Configure: Sanitize (Auto OS)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "conf",
        "auto"
      ],
      "problemMatcher": [],
      "detail": "Configure sanitizer profile with OS-aware toolchain selection."
    },
    {
      "label": "Configure: Sanitize (Clang)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "conf",
        "clang"
      ],
      "problemMatcher": [],
      "detail": "Configure sanitizer profile using Clang."
    },
    {
      "label": "Configure: Sanitize (GCC Linux Only)",
      "type": "shell",
      "command": "sh",
      "args": [
        "${workspaceFolder}/.vscode/scripts/cp_sanitize_task.sh",
        "conf",
        "gcc"
      ],
      "problemMatcher": [],
      "detail": "Configure sanitizer profile using GCC. Linux-only; macOS is explicitly blocked."
    },
    {
      "label": "Info: Show Active CP Profile",
      "type": "shell",
      "command": "cpptools",
      "args": ["info"],
      "problemMatcher": [],
      "detail": "Display active build profile, compiler, and CP workspace diagnostics."
    },
    {
      "label": "Clean: Build Artifacts",
      "type": "shell",
      "command": "cpptools",
      "args": ["clean"],
      "problemMatcher": [],
      "detail": "Remove generated build artifacts."
    }
  ],
  "inputs": [
    {
      "id": "inputFile",
      "type": "promptString",
      "description": "Input file for cppgo (relative to workspace or absolute path)",
      "default": "${fileBasenameNoExtension}.in"
    },
    {
      "id": "stressIterations",
      "type": "pickString",
      "description": "Stress-test iteration count",
      "options": ["50", "100", "200", "500", "1000"],
      "default": "200"
    }
  ]
}
